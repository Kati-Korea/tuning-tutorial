<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>중급자를 위한 견인고리 장치 | 히치 등급·하중·설치·검사 가이드</title>
  <style>
    :root { --bg:#ffffff; --text:#222; --muted:#666; --primary:#0c6efd; --accent:#f0f4ff; --card:#fafafa; --border:#e5e7eb; --caption-bg:#f8fafc; --caption-text:#6b7280; --ad-bg:#d8d8d8; }
    *{box-sizing:border-box}
    body{margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR",Arial,"Apple SD Gothic Neo","Malgun Gothic","맑은 고딕",sans-serif;background:var(--bg);color:var(--text);line-height:1.65}
    a{color:var(--primary);text-decoration:none}
    a:hover{text-decoration:underline}
    .wrap{max-width:1040px;margin:0 auto;padding:24px}
    .partner-inner{max-width:1040px;margin:0 auto;padding:10px 24px;display:flex;align-items:center;gap:14px;flex-wrap:wrap;justify-content:center;text-align:center}
    .partner{display:flex;align-items:center;gap:6px}
    .partner img{height:28px;width:auto;object-fit:contain;display:block}
    .partner .text-box{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:28px}
    .partner .name{font-size:13px;font-weight:600;color:var(--text);margin:0}
    .partner .url{font-size:11px;color:var(--muted);margin:0}
    header .brand{display:flex;align-items:center;gap:8px;flex-wrap:wrap;justify-content:center;text-align:center;width:100%}
    header .brand h1{width:100%;margin:0;font-size:20px;font-weight:700}
    .grid{display:grid;grid-template-columns:1.2fr 2fr;gap:24px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
    .toc{position:sticky;top:12px;align-self:start;background:var(--card);border:1px solid var(--border);border-radius:10px;padding:16px}
    .toc h3{margin:0 0 12px;font-size:16px;border-bottom:1px dashed var(--border);padding-bottom:8px;text-align:center}
    .toc ol{margin:0;padding-left:16px;font-size:13px;line-height:1.5}
    .toc li{margin:4px 0}
    .back{display:block;width:100%;text-align:center;padding:8px 12px;border-radius:8px;background:#eef2ff;border:1px solid var(--border);color:#1f2937;font-size:14px;font-weight:600;margin-bottom:12px;text-decoration:none}
    .back:hover{filter:brightness(1.03);text-decoration:none}
    .banner-stack{margin-top:12px;display:flex;flex-direction:column;gap:10px}
    .banner{display:grid;grid-template-columns:88px 1fr;gap:10px;width:100%;background:#fff;border:1px solid var(--border);border-radius:10px;padding:10px;text-decoration:none;transition:box-shadow .2s ease,transform .2s ease;align-items:center}
    .banner:hover{box-shadow:0 4px 14px rgba(0,0,0,0.08);transform:translateY(-1px)}
    .banner .content .title{margin:0;font-size:14px;color:var(--text);font-weight:600}
    .banner .content .desc{margin:2px 0 0;font-size:12px;color:var(--muted)}
    .section{background:var(--bg);border:1px solid var(--border);border-radius:10px;padding:16px;margin-bottom:18px;position:relative}
    .section h3{margin:0 0 8px;font-size:18px}
    .section .subtitle{color:var(--muted);margin-bottom:12px;font-size:14px}
    .callout{background:var(--accent);border-left:4px solid var(--primary);padding:10px 12px;border-radius:6px;margin:10px 0;font-size:14px}
    .footer{margin-top:16px;padding:16px 0 40px;color:var(--muted);font-size:13px;border-top:1px solid var(--border)}
    .tag{display:inline-block;border:1px solid var(--border);border-radius:999px;padding:4px 10px;font-size:12px;color:var(--muted);margin-right:6px}
    figure.img-card{margin:8px auto 12px;padding:8px;border:1px solid var(--border);border-radius:10px;background:#fff;width:fit-content}
    .img-376,.img-576,.img-vid,.img-ad{overflow:hidden;border-radius:6px}
    .img-376{width:376px;height:376px}
    .img-576{width:576px;height:576px}
    .img-vid{width:376px;height:211px}
    .img-ad{width:576px;height:776px;border-radius:8px}
    .img-376>img,.img-576>img,.img-vid>img,.img-ad>img{width:100%;height:100%;object-fit:cover;object-position:center;display:block}
    figcaption.credit{margin-top:6px;padding:6px 8px;background:var(--caption-bg);color:var(--caption-text);border:1px dashed var(--border);border-radius:6px;font-size:12px;line-height:1.4}
    figcaption.credit a{color:inherit;text-decoration:underline;text-underline-offset:2px}
    .center{text-align:center}
    .center-inline{display:inline-block}
    .video-overlay{position:fixed;inset:0;background:rgba(0,0,0,0.6);display:none;align-items:center;justify-content:center;z-index:1000;padding:16px}
    .video-overlay.active{display:flex}
    .video-modal{position:relative;background:#000;border-radius:10px;overflow:hidden;box-shadow:0 10px 30px rgba(0,0,0,0.35);width:min(90vw,1280px);height:min(80vh,720px)}
    .video-modal iframe{width:100%;height:100%;display:block;border:0}
    .video-close{position:absolute;top:8px;right:8px;background:rgba(255,255,255,0.9);color:#111;border:none;border-radius:999px;width:32px;height:32px;font-size:18px;cursor:pointer;line-height:32px;text-align:center;box-shadow:0 2px 6px rgba(0,0,0,0.2)}
    .video-close:hover{background:#fff}
    .video-thumb{cursor:pointer}
    .ad-section{background:var(--ad-bg);border-color:#cfcfcf}
    .ad-card{display:inline-block;padding:10px;border-radius:10px;background:#fff;border:1px solid var(--border)}
    .ad-link{display:inline-block;margin-top:6px;font-size:12px;color:var(--muted)}
    .video-error {
      position:fixed; left:50%; top:16px; transform:translateX(-50%);
      background:#fee2e2; color:#991b1b; border:1px solid #fecaca; border-radius:8px;
      padding:8px 12px; font-size:12px; display:none; z-index:1100;
      box-shadow:0 6px 16px rgba(0,0,0,0.15);
    }
    .video-error a { color:#991b1b; text-decoration:underline; }
  </style>
  <link rel="icon" href="/logo_Icon.ico">
</head>
<body>
  <div class="wrap">
    <header>
      <div class="brand">
        <h1>중급자를 위한 견인고리 · 히치 등급·하중·설치·검사 가이드</h1>
        <span class="tag">중급</span>
        <span class="tag">한국 기준</span>
      </div>
      <div class="partner-inner">
        <a class="partner" href="http://www.katiagroup.or.kr/" target="_blank" rel="noopener" aria-label="KATIA">
          <img src="../image/logo_new.png" alt="KATIA 로고">
          <div class="text-box">
            <div class="name">Korea Auto Tuning Industry Association</div>
            <div class="url">www.katiagroup.or.kr</div>
          </div>
        </a>
        <a class="partner" href="http://www.kal.ac.kr" target="_blank" rel="noopener" aria-label="KAL">
          <img src="../image/kal_logo.png" alt="KAL 로고">
          <div class="text-box">
            <div class="name">KAL</div>
            <div class="url">www.kal.ac.kr</div>
          </div>
        </a>
      </div>
    </header>

    <div class="grid">
      <nav class="toc">
        <a class="back" href="../menu02.html" aria-label="이전 페이지로">← 이전 페이지</a>
        <h3>견인고리<br>선택·설치·세팅·검사 가이드</h3>
        <h3>▣ 목 차 ▣</h3>
        <ol>
          <li><a href="#cover">표지</a></li>
          <li><a href="#can-do">서문·학습 목표</a></li>
          <li><a href="#abs-easy">NCS 직무 정의</a></li>
          <li><a href="#safety-prep">견인 시스템 개요</a></li>
          <li><a href="#terms-5">하중의 기초 물리</a></li>
          <li><a href="#checklist">견인 용량·차량 한계</a></li>
          <li><a href="#legal">히치 등급·타입</a></li>
          <li><a href="#symptoms">전기 하네스·등화 연동</a></li>
          <li><a href="#maintenance">설치 SOP-차체/프레임</a></li>
          <li><a href="#bleeding-comm">설치 SOP-전기 배선</a></li>
          <li><a href="#core-principles">설치 SOP-안전장구</a></li>
          <li><a href="#test">적재·주행·브레이크 테스트</a></li>
          <li><a href="#upgrade">리스크·트러블슈팅</a></li>
          <li><a href="#choose-pro">법령·검사·인증</a></li>
          <li><a href="#troubleshoot">Q&A 초간단</a></li>
          <li><a href="#data">부록 A~D</a></li>
        </ol>

        <div class="banner-stack" aria-label="권장 링크 배너">
          <a class="banner" href="https://www.youtube.com/results?search_query=trailer+hitch+basics+classes+explained" target="_blank" rel="noopener">
            <img src="https://images.unsplash.com/photo-1517336714731-489689fd1ca8?q=80&w=400&auto=format&fit=crop" style="width:80px;height:60px;object-fit:cover;border-radius:8px;border:1px solid var(--border);display:block" alt="히치 개요">
            <div class="content">
              <p class="title">개념 영상</p>
              <p class="desc">히치 등급·용도</p>
            </div>
          </a>
          <a class="banner" href="https://www.youtube.com/results?search_query=tongue+weight+distribution+hitch+setup" target="_blank" rel="noopener">
            <img src="https://images.unsplash.com/photo-1588774069162-5a6f0bbefbd6?q=80&w=400&auto=format&fit=crop" style="width:80px;height:60px;object-fit:cover;border-radius:8px;border:1px solid var(--border);display:block" alt="하중 기초">
            <div class="content">
              <p class="title">하중·배분</p>
              <p class="desc">텅웨이트·WD 히치</p>
            </div>
          </a>
          <a class="banner" href="https://main.kotsa.or.kr/main.do" target="_blank" rel="noopener">
            <img src="https://main.kotsa.or.kr/web/images/common/logo.svg" style="width:80px;height:60px;object-fit:cover;border-radius:8px;border:1px solid var(--border);display:block" alt="TS한국교통안전공단 로고">
            <div class="content">
              <p class="title">TS한국교통안전공단</p>
              <p class="desc">검사·안전·튜닝인증</p>
            </div>
          </a>
        </div>
      </nav>

      <main>
        <section id="cover" class="section">
          <div class="center">
            <figure class="img-card center-inline">
              <div class="img-576">
                <img src="https://images.unsplash.com/photo-1502877338535-766e1452684a?q=80&w=1200&auto=format&fit=crop" alt="견인고리 표지 이미지">
              </div>
              <div class="ad-link">표지 · 예시 이미지(Unsplash)</div>
            </figure>
          </div>
        </section>

        <section id="can-do" class="section" data-index="1">
          <h3>01. 서문·학습 목표</h3>
          <div class="subtitle">왜 ‘견인고리’인가</div>
          <ul>
            <li>핵심 가치: 적재·레저·작업 활용성 확대, 적법·안전 견인 구현</li>
            <li>학습 목표: 하중/등급 이해→설치/배선 SOP→검사·운용 준수</li>
            <li>로드맵: 시스템 개요→물리→히치/하네스→설치→검사→운용</li>
          </ul>
          <div class="center">
            <figure class="img-card center-inline">
              <div class="img-376">
                <img src="https://images.unsplash.com/photo-1551836022-4c4c79ecde51?q=80&w=1000&auto=format&fit=crop" alt="견인의 가치">
              </div>
              <div class="ad-link">vehicle towing camping trailer utility(키워드)</div>
            </figure>
          </div>
        </section>

        <section id="abs-easy" class="section" data-index="2">
          <h3>02. NCS 관점의 직무 정의</h3>
          <ul>
            <li>요구분석: 적재물/트레일러 규격·차량 등급·법정 용량 파악</li>
            <li>작업 계획: 부품 리스트, 설치 위치·공구·배선 경로·리스크</li>
            <li>품질관리: 체결 토크·전기 점검표·시험 주행·문서화</li>
          </ul>
          <div class="center">
            <figure class="img-card center-inline">
              <div class="img-376">
                <img src="https://images.unsplash.com/photo-1583508915901-b5f84c1dcde1?q=80&w=1000&auto=format&fit=crop" alt="NCS 직무 흐름">
              </div>
              <div class="ad-link">towing service workflow checklist(키워드)</div>
            </figure>
          </div>
        </section>

        <section id="safety-prep" class="section" data-index="3">
          <h3>03. 견인 시스템 개요</h3>
          <ul>
            <li>구성: 차체 마운트 브래킷·리시버·볼마운트·세이프티 체인·전기 하네스(7/13핀)</li>
            <li>연계: 차량-히치-트레일러 하중 경로·브레이크/등화 연동</li>
            <li>유형: 고정식/탈착식, 리시버 1.25"/2", WD(Weight Distribution) 히치</li>
          </ul>
          <div class="center">
            <figure class="img-card center-inline">
              <div class="img-376">
                <img src="https://images.unsplash.com/photo-1609354542218-6d9e1f7a5f91?q=80&w=1000&auto=format&fit=crop" alt="시스템 개요">
              </div>
              <div class="ad-link">tow hitch components receiver ball mount safety chain(키워드)</div>
            </figure>
          </div>
        </section>

        <section id="terms-5" class="section" data-index="4">
          <h3>04. 하중의 기초 물리</h3>
          <ul>
            <li>텅웨이트: 총 트레일러 중량의 10~15% 목표, 전/후배분 안정성</li>
            <li>전단·인장·모멘트 하중과 브래킷/볼트 등급의 상관</li>
            <li>스누버/안티스웨이·WD 바·힌지 모멘트로 피치/스웨이 억제</li>
          </ul>
        </section>

        <section id="checklist" class="section" data-index="5">
          <h3>05. 견인 용량·차량 한계</h3>
          <ul>
            <li>차량 제원: 공차중량·GVWR·GCWR·허용 히치 하중 확인</li>
            <li>브레이크: 트레일러 독립 브레이크 의무/권고 기준 준수</li>
            <li>오버로드 방지: 언덕·고온·고도 영향, 냉각/변속기 하중 관리</li>
          </ul>
          <div class="center">
            <figure class="img-card center-inline">
              <div class="img-376">
                <img src="https://images.unsplash.com/photo-1559339352-11d035aa65de?q=80&w=1000&auto=format&fit=crop" alt="용량·한계">
              </div>
              <div class="ad-link">towing capacity gvwr gcwr tongue weight scale(키워드)</div>
            </figure>
          </div>
        </section>

        <section id="legal" class="section" data-index="6">
          <h3>06. 히치 등급·타입</h3>
          <ul>
            <li>등급(예): Class I~IV, 최대 하중/텅웨이트/리시버 규격</li>
            <li>타입: 볼마운트/핀·클립, 스웨이 컨트롤, WD 히치 선택 기준</li>
            <li>커넥터: 7/13핀 배선 규격, 방수·방청 기준</li>
          </ul>
        </section>

        <section id="symptoms" class="section" data-index="7">
          <h3>07. 전기 하네스·등화 연동</h3>
          <ul>
            <li>배선: 전원/접지/좌·우 방향지시/미등/정지등, 역전류 방지 모듈</li>
            <li>차종 특성: CAN/램프 진단 경고 회피(리레이/모듈 사용)</li>
            <li>방수: 커넥터/개구부 실링, 하네스 루트 보호</li>
          </ul>
          <div class="center">
            <figure class="img-card center-inline">
              <div class="img-vid video-thumb" data-video-id="" role="button" aria-label="하네스 연동 영상 재생">
                <img src="https://images.unsplash.com/photo-1511910849309-0dffb8785146?q=80&w=1000&auto=format&fit=crop" alt="전기 하네스">
              </div>
              <div class="ad-link">trailer wiring 7 pin 13 pin canbus module(영상 키워드)</div>
            </figure>
          </div>
        </section>

        <section id="maintenance" class="section" data-index="8">
          <h3>08. 설치 SOP-차체/프레임</h3>
          <ul>
            <li>차체 마운트 포인트 확인, 토크 스펙 준수, 러스트 방지 코팅</li>
            <li>프레임 너트플레이트 삽입·정렬, 핀·클립 안전 체결</li>
            <li>배기·범퍼·스페어타이어 간섭 확인, 홀 가공 시 방청</li>
          </ul>
          <div class="center">
            <figure class="img-card center-inline">
              <div class="img-376">
                <img src="https://images.unsplash.com/photo-1592853625600-22f0f52acae2?q=80&w=1000&auto=format&fit=crop" alt="차체/프레임 설치">
              </div>
              <div class="ad-link">hitch frame mount torque spec rust prevention(키워드)</div>
            </figure>
          </div>
        </section>

        <section id="bleeding-comm" class="section" data-index="9">
          <h3>09. 설치 SOP-전기 배선</h3>
          <ul>
            <li>퓨즈·릴레이·하네스 보호튜브 적용, 차체 그라운드 품질 확보</li>
            <li>테일램프 인터페이스/BCM 연동, 진단 경고 방지 로직</li>
            <li>커넥터 위치·도장면 손상 방지·드립루프 구성</li>
          </ul>
          <div class="center">
            <figure class="img-card center-inline">
              <div class="img-376">
                <img src="https://images.unsplash.com/photo-1586253634025-83e9b07e7c44?q=80&w=1000&auto=format&fit=crop" alt="전기 배선">
              </div>
              <div class="ad-link">trailer wiring harness install waterproofing(키워드)</div>
            </figure>
          </div>
        </section>

        <section id="core-principles" class="section" data-index="10">
          <h3>10. 설치 SOP-안전장구</h3>
          <ul>
            <li>세이프티 체인 교차 연결, 적정 길이·하중 등급 확인</li>
            <li>브레이크웨이 케이블 장착·테스트(전동 브레이크 트레일러)</li>
            <li>볼마운트 높이·수평 조정, 핀·락 장치 상태 확인</li>
          </ul>
        </section>

        <section id="test" class="section" data-index="11">
          <h3>11. 적재·주행·브레이크 테스트</h3>
          <ul>
            <li>텅웨이트 측정·배분 조정, 공기압·서스펜션 레벨 확인</li>
            <li>저속·중속 직진/차선 변경·제동 테스트, 스웨이 모니터링</li>
            <li>브레이크 컨트롤러 캘리브레이션·페이드 확인</li>
          </ul>
        </section>

        <section id="upgrade" class="section" data-index="12">
          <h3>12. 리스크·트러블슈팅</h3>
          <ul>
            <li>스웨이: 하중 배분·속도·스웨이 컨트롤 장치 점검</li>
            <li>전기 이상: 접지 불량·퓨즈 용량·침수 → 회복/재배선</li>
            <li>체결 이완: 재토크 주기·방진 와셔·락타이트 적용</li>
          </ul>
        </section>

        <section id="choose-pro" class="section" data-index="13">
          <h3>13. 법령·검사·인증</h3>
          <ul>
            <li>구조변경·튜닝 인증 절차, 등화·번호판 가림 금지 준수</li>
            <li>견인 장치 등급·표기, 최대 견인·수직하중 문서화</li>
            <li>보험·책임 범위 고지, 취급 설명서·점검표 교부</li>
          </ul>
        </section>

        <section id="troubleshoot" class="section" data-index="14">
          <h3>14. Q&A 초간단</h3>
          <ul>
            <li><strong>Q. WD 히치는 꼭 필요한가요?</strong> — A. 텅웨이트가 높고 리어 서스펜션 처짐이 크면 WD 히치가 안정성에 유리합니다.</li>
            <li><strong>Q. 7핀과 13핀 중 무엇을 써야 하나요?</strong> — A. 트레일러 등화·보조전원 필요에 따라 13핀이 유리하며 방수·전류 용량도 고려하세요.</li>
            <li><strong>Q. 법적 최대 견인중량을 초과하면?</strong> — A. 불법이며 사고 시 책임이 커집니다. 차량 제원과 인증서 기준을 반드시 준수하세요.</li>
          </ul>
        </section>

        <section id="data" class="section" data-index="15">
          <h3>15. 부록 A~D</h3>
          <ul>
            <li><strong>부록 A</strong> 작업 체크리스트(체결 토크·배선·방수·표기)</li>
            <li><strong>부록 B</strong> 품질 점검표(QA): 스웨이·제동·등화·누설</li>
            <li><strong>부록 C</strong> 트러블슈팅 플로우(증상→원인→대책)</li>
            <li><strong>부록 D</strong> 사용자 안내문: 연결 순서·주행 수칙·점검 주기</li>
          </ul>
        </section>

        <section class="section ad-section">
          <div class="center">
            <div class="ad-card">
              <a href="https://www.youtube.com/results?search_query=how+to+install+trailer+hitch+and+wiring" target="_blank" rel="noopener" aria-label="히치 설치·배선 참고">
                <div class="img-ad">
                  <img src="https://images.unsplash.com/photo-1521791055366-0d553872125f?q=80&w=1200&auto=format&fit=crop" alt="히치 배너">
                </div>
              </a>
              <div class="ad-link">히치 설치·WD 세팅·전기 배선 · 참고 영상</div>
            </div>
          </div>
        </section>
      </main>
    </div>

    <div class="footer">
      <div class="center">설치 전 차량·히치 등급과 하중을 검토하고, 설치 후 체결·배선·주행 테스트 및 법적 검사를 완료하세요.</div>
    </div>

  </div>

  <div class="video-error" id="videoError" role="alert" aria-live="polite">
    동영상 임베드가 제한되어 재생할 수 없습니다. 아래 링크로 YouTube에서 직접 보세요.
    <a id="videoOpenLink" href="#" target="_blank" rel="noopener">YouTube에서 열기</a>
  </div>

  <div class="video-overlay" id="videoOverlay" aria-hidden="true">
    <div class="video-modal" role="dialog" aria-modal="true" aria-label="영상 재생">
      <button class="video-close" id="videoClose" aria-label="닫기">✕</button>
      <iframe id="videoFrame"
              src=""
              title="YouTube video player"
              allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; fullscreen"
              allowfullscreen>
      </iframe>
    </div>
  </div>

  <script>
    function buildEmbedUrl(videoId, startSec, useNoCookie, autoplay = true, muted = true, controls = 1, playsinline = 1) {
      if (!videoId) return null;
      const base = useNoCookie ? 'https://www.youtube-nocookie.com' : 'https://www.youtube.com';
      const params = new URLSearchParams({
        rel: '0',
        modestbranding: '1',
        playsinline: String(playsinline),
        controls: String(controls),
        enablejsapi: '1',
        origin: window.location.origin,
      });
      if (autoplay) params.set('autoplay', '1');
      if (muted) params.set('mute', '1');
      if (startSec) {
        const s = String(startSec).replace('s','');
        if (/^\d+$/.test(s)) params.set('start', s);
      }
      return `${base}/embed/${videoId}?${params.toString()}`;
    }

    function extractVideoId(raw) {
      if (!raw) return null;
      if (/^[A-Za-z0-9_-]{6,}$/.test(raw) && !raw.includes('http')) return raw;
      try {
        const url = new URL(raw);
        const host = url.hostname.replace('www.', '');
        if (host.includes('youtu.be')) return url.pathname.slice(1);
        if (host.includes('youtube')) {
          if (url.pathname === '/watch') return url.searchParams.get('v');
          if (url.pathname.startsWith('/shorts/')) return url.pathname.split('/')[2];
          if (url.pathname.startsWith('/embed/')) return url.pathname.split('/')[2];
        }
      } catch(e) {
        const m = String(raw).match(/(?:youtu\.be\/|v=|\/shorts\/|\/embed\/)([A-Za-z0-9_-]{6,})/);
        if (m) return m[1];
      }
      return null;
    }

    const overlay = document.getElementById('videoOverlay');
    const frame = document.getElementById('videoFrame');
    const btnClose = document.getElementById('videoClose');
    const errorBanner = document.getElementById('videoError');
    const openLink = document.getElementById('videoOpenLink');

    function showError(originalUrl) {
      if (!errorBanner) return;
      openLink.href = originalUrl || '#';
      errorBanner.style.display = 'block';
      clearTimeout(showError._t);
      showError._t = setTimeout(() => { errorBanner.style.display = 'none'; }, 8000);
    }

    function openOverlay() {
      overlay.classList.add('active');
      overlay.setAttribute('aria-hidden', 'false');
      document.body.style.overflow = 'hidden';
      btnClose.focus();
    }

    function closeOverlay() {
      overlay.classList.remove('active');
      overlay.setAttribute('aria-hidden', 'true');
      document.body.style.overflow = '';
      try { frame.src = ''; } catch(e){}
    }

    async function tryPlaySequence(options) {
      const { id, start, originalUrl } = options || {};
      openOverlay();
      try {
        frame.src = buildEmbedUrl(id, start, false, true, true);
      } catch (e1) {
        try {
          frame.src = buildEmbedUrl(id, start, true, true, true);
        } catch (e2) {
          closeOverlay();
          showError(originalUrl);
        }
      }
    }

    document.addEventListener('click', function (e) {
      const thumb = e.target.closest('.video-thumb');
      if (!thumb) return;

      e.preventDefault();
      let id = thumb.getAttribute('data-video-id') || '';
      let start = thumb.getAttribute('data-start') || '';
      let originalUrl = thumb.getAttribute('data-video-url') || '';

      if (!id && originalUrl) {
        id = extractVideoId(originalUrl);
        try {
          const u = new URL(originalUrl);
          start = start || u.searchParams.get('t') || u.searchParams.get('start') || '';
        } catch(e){}
      }
      if (!originalUrl && id) originalUrl = `https://www.youtube.com/watch?v=${id}`;

      if (id) {
        tryPlaySequence({ id, start, originalUrl });
      } else if (originalUrl) {
        showError(originalUrl);
      }
    });

    btnClose.addEventListener('click', closeOverlay);
    overlay.addEventListener('click', function (e) {
      if (e.target === overlay) closeOverlay();
    });
    document.addEventListener('keydown', function (e) {
      if (e.key === 'Escape' && overlay.classList.contains('active')) closeOverlay();
    });
  </script>
</body>
</html>